<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login QR Absen</title>
  <style>
    body { font-family:'Segoe UI',sans-serif; background:#111; color:#fff; text-align:center; margin:0; }
    header { background:#b40000; padding:20px; }
    header img { width:220px; }
    header h1 { margin:10px 0 0; font-size:1.5em; }
    header h2 { margin:5px 0 0; font-size:1.2em; }
    .container { padding:40px 20px; }

    input[type="password"]{
      font-size:1.1em; padding:12px; width:100%; max-width:300px; margin:20px auto 10px;
      border:1px solid #2a2a2e; border-radius:8px; text-align:center; background:#101010; color:#fff;
      display:block;
    }
    .btn{
      font-size:1.05em; background:#b40000; color:#fff; border:none; border-radius:10px; cursor:pointer;
      padding:14px; transition:background-color .3s ease, transform .15s ease; width:100%; max-width:300px; margin:8px auto 0;
    }
    .btn:hover{ background:#ff1c1c; transform:scale(1.03); }

    .area-selection{ display:none; margin-top:24px; }
    .cluster-badge{ display:inline-block; padding:6px 12px; border:1px solid #ff7a7a; color:#ffd3d3; border-radius:999px; margin-bottom:12px; }
    .area-title{ font-size:1.1em; margin:6px 0 16px; color:#ccc; }
    .area-grid{
      display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:15px; max-width:520px; margin:0 auto;
    }
    .area-grid .btn{ max-width:unset; }
    @media (max-width:480px){ .area-grid{ grid-template-columns:1fr; } }
  </style>
</head>
<body>

<header>
  <img src="logo_telkom_akses.png" alt="Logo Telkom Akses" />
  <h1>SAPA - QR</h1>
  <h2>SISTEM ABSENSI PAKAI QR</h2>
</header>

<div class="container">
  <!-- FORM LOGIN -->
  <div id="login-form">
    <form onsubmit="cekPassword(); return false;">
      <p>Masukkan password untuk mengakses halaman QR:</p>
      <input type="password" id="pass" placeholder="Masukkan Password Sesuai Area" />
      <button type="submit" class="btn">🔒 Masuk</button>
      <div id="err" style="display:none; color:#ffc1c1; margin-top:8px;">Password salah. Coba lagi.</div>
    </form>
  </div>

  <!-- PILIHAN AREA SESUAI CLUSTER -->
  <div id="area-selection" class="area-selection">
    <div class="cluster-badge" id="clusterBadge">Cluster</div>
    <p class="area-title">📌 Pilih area untuk menampilkan QR:</p>
    <div class="area-grid" id="areaGrid"></div>
    <div style="margin-top:14px;">
      <button class="btn" onclick="logout()">Ganti Area</button>
    </div>
  </div>
</div>

<script>
  // ---- KONFIG: daftar cluster & sub-area ----
  // href = nama file sub-area kamu
  const CLUSTERS = {
    "7qvt6": {
      name: "PASURUAN",
      areas: [
        { label:"📍 Pasuruan",     href:"psn.html" },
        { label:"📍 Plasa",        href:"plasa.html" },
        { label:"📍 Probolinggo",  href:"pbl.html" },
        { label:"📍 Probolinggo 2",href:"pbl2.html" },
        { label:"📍 Kraksaan",     href:"krz.html" },
        { label:"📍 Lumajang",     href:"lmj.html" },
      ]
    },
    "xvk98": {
      name: "JEMBER",
      areas: [
        { label:"📍 Jember",       href:"jember.html" },
        { label:"📍 Kebonsari",    href:"kebonsari.html" },
        { label:"📍 Puger",        href:"puger.html" },
        { label:"📍 Situbondo",    href:"situbondo.html" },
        { label:"📍 Bondowoso",    href:"bondowoso.html" },
        { label:"📍 Banyuwangi",   href:"banyuwangi.html" },
        { label:"📍 Genteng",      href:"genteng.html" },
      ]
    }
  };

  const BASE_PATH = ""; // isi "/nama-repo/" jika file di subfolder GitHub Pages

  function renderAreas(key){
    const cfg = CLUSTERS[key]; if(!cfg) return;
    document.getElementById('clusterBadge').textContent = "Cluster " + cfg.name;
    const grid = document.getElementById('areaGrid');
    grid.innerHTML = "";
    cfg.areas.forEach(a => {
      const b = document.createElement('button');
      b.className = "btn";
      b.textContent = a.label;
      b.onclick = () => { location.href = BASE_PATH + a.href; }; // TANPA ?auth
      grid.appendChild(b);
    });
  }

  function cekPassword(){
    const pass = document.getElementById("pass").value.trim();
    const ok = !!CLUSTERS[pass];
    document.getElementById('err').style.display = ok ? 'none' : 'block';
    if (!ok) return;

    // simpan sesi & tampilkan menu cluster
    sessionStorage.setItem("loginQR","true");
    sessionStorage.setItem("clusterKey", pass);
    document.getElementById("login-form").style.display = "none";
    document.getElementById("area-selection").style.display = "block";
    renderAreas(pass);
  }

  function logout(){
    sessionStorage.removeItem("loginQR");
    sessionStorage.removeItem("clusterKey");
    document.getElementById("area-selection").style.display = "none";
    document.getElementById("login-form").style.display = "block";
    document.getElementById("pass").value = "";
  }

  // Saat reload: kalau sudah login, langsung tampilkan pilihan cluster yg sesuai
  window.onload = function(){
    const key = sessionStorage.getItem("clusterKey");
    if (sessionStorage.getItem("loginQR")==="true" && CLUSTERS[key]){
      document.getElementById("login-form").style.display = "none";
      document.getElementById("area-selection").style.display = "block";
      renderAreas(key);
    }
  };
</script>

</body>
</html>
