<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>QR PBL</title>
  <script>
    async function loadTokenAndRedirect() {
      const area = "PBL";
      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbXXXXX/exec?action=getToken&area=" + area);
        const data = await response.json();
        const token = data.token;
        if (!token) throw new Error("Token kosong");
        window.location.href = "https://t.me/absensi_qr_bot/webapp?start=" + token + "_" + area;
      } catch (err) {
        document.body.innerHTML = `<h2>Gagal mengambil token: ${err.message}</h2>`;
      }
    }
    window.onload = loadTokenAndRedirect;
  </script>
</head>
<body>
  <h2>Memuat QR PBL...</h2>
</body>
</html>
