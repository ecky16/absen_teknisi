
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Absen Teknisi</title>
    <script>
      window.onload = async () => {
        const params = new URLSearchParams(window.location.search);
        const token = params.get("startapp");

        if (!window.Telegram.WebApp.initDataUnsafe?.user) {
          document.body.innerHTML = `<h3 style="color:red;">❌ Telegram tidak ditemukan</h3>`;
          return;
        }

        const nama = window.Telegram.WebApp.initDataUnsafe.user.first_name;
        const id = window.Telegram.WebApp.initDataUnsafe.user.id;

        document.getElementById("info").innerText = `Halo ${nama}! Klik tombol di bawah untuk absen.`;

        document.getElementById("btn").onclick = async () => {
          const res = await fetch(`https://script.google.com/macros/s/AKfycbyTngIjAKyIKM3JvMmUF0iHXnspbyiTslbd3qnU_QQ13muocEl_431Wp-cdGd-qvZgO/exec?token=${token}&nama=${nama}&id=${id}`);
          const html = await res.text();
          document.body.innerHTML = html;
        };
      };
    </script>
  </head>
  <body style="background:black;color:white;text-align:center;font-family:sans-serif;padding-top:100px;">
    <h2 id="info">Memuat...</h2>
    <button id="btn" style="padding:10px 20px;font-size:18px;">✅ Klik untuk Absen</button>
  </body>
</html>
